## First, we need we need to create a new folder within 05.BAM, called "noDupl_RG" and to create a new sample list, see below.
cd /scratch/project_2009316/DutchSamples/X204SC23115958-Z01-F008/05.BAM/nodupl
mkdir /scratch/project_2009316/DutchSamples/X204SC23115958-Z01-F008/05.BAM/nodupl_RG
ls *bam > nodupl_name.list


#!/bin/bash -l
#SBATCH -J RGs
#SBATCH -o /scratch/project_2009316/DutchSamples/X204SC23115958-Z01-F008/05.BAM/logs/RGs_%j.out
#SBATCH -e /scratch/project_2009316/DutchSamples/X204SC23115958-Z01-F008/05.BAM/logs/RGs_%j.err
#SBATCH --account=project_2009316
#SBATCH -t 04:00:00
#SBATCH -p small
#SBATCH --array=1-18
#SBATCH --ntasks 1
#SBATCH --mem-per-cpu=4GB

module load biokit

FINALDIR=/scratch/project_2009316/DutchSamples/X204SC23115958-Z01-F008/05.BAM/noDupl_RG

cd /scratch/project_2009316/DutchSamples/X204SC23115958-Z01-F008/05.BAM/nodupl
file=$(sed -n "$SLURM_ARRAY_TASK_ID"p nodupl_name.list)

sample=${file%_nodupl*}

###
### Add read group
###

# Add RGs
picard AddOrReplaceReadGroups \
    I=$file \
    O=$FINALDIR/$sample"_nodupl_wRG.bam" \
    RGID=$sample \
    RGPL=illumina \
    RGLB=1 \
    RGSM=$sample \
    RGPU=1 \
    TMP_DIR=/scratch/project_2009316/DutchSamples/X204SC23115958-Z01-F008/temp

# Index
samtools index $FINALDIR/$sample"_nodupl_wRG.bam"

### END
